package com.sample;
 dialect "mvel"
import org.kie.api.runtime.KieRuntime
import java.util.ArrayList
import javax.swing.JOptionPane
import javax.swing.JFrame
import java.util.Arrays
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import java.util.List;

global JFrame frame

declare Instance
	decision : String
	question : String
	response : List	
end

function void ask(JFrame frame, Instance ins) {
		
		ins.setDecision((String) JOptionPane.showInputDialog(frame,
											 ins.getQuestion(),
											 "Question",
											 JOptionPane.QUESTION_MESSAGE,
											 null,
											 ins.getResponse().toArray(),
											 ins.getResponse().toArray()[0]));
}
function void result(JFrame frame, Instance ins) {
		List ok =new ArrayList(Arrays.asList("Confirm"));
		
		JOptionPane.showOptionDialog(frame,
											 ins.getResponse().toArray()[0],
											 "Result",JOptionPane.YES_NO_OPTION,
											 JOptionPane.QUESTION_MESSAGE,
											 null,
											 ok.toArray(),ok.toArray()[0]
											 );
		
}

rule "start"
	then
		Instance ins = new Instance();
		ins.setQuestion("Why do you want a classic car?");
		ins.setResponse(Arrays.asList("Reliability and convenience bore me",
		"I guess I'm making some kind of statement about something?",
		"I prefer the style",
		"New cars have no soul", "Love speed "));
		insert(ins);
		ask(frame, ins);
		update(ins)
end

rule "Why do you want a classic car?"
	when
		m : Instance(question == "Why do you want a classic car?")
	then
		Instance ins = new Instance();
		if (m.getDecision()==(m.getResponse().get(0))) {
			ins.setQuestion("Oh yeah thats why?");
			ins.setResponse(Arrays.asList("I'm erotically drawn to tow trucks and freeway shoulders",
			 "I want to know how cars work"));
		} else if{ (m.getDecision().equals(m.getResponse().get(1)))
			ins.setQuestion("Great what statement?");
			ins.setResponse(Arrays.asList("The mothership left me ins paris",
			"I live dangerously and nader can suck it",
			"I'm a kook, an American Kook",
			"I take driving seriously and have the gloves to prove it",
			"My wallet is on the chain",
			"I'm a refugee from an alternate future, with zeppelins and shit",
			"I hate people knowing what ins drive",
			"I kinda wanted a motorcycle but I have no balance",
			"I like being part of a massive automotive subculture",
			"I will only drive vehicles with two distinct luggage areas",
			"I run an nye themed diner ins Las Vegas",
			"I'm really rich but I like to pretend a hippie",
			));
		}
		insert(ins);
		ask(frame, ins);
		update(ins)
end

rule "Oh yeah thats why?"
	when
		m : Instance(question == "Oh yeah thats why?")
	then
		Instance ins = new Instance();
		if (m.getDecision()==(m.getResponse().get(0))) {
			ins.setQuestion("Ok, should it be pretty quick?");
			ins.setResponse(Arrays.asList("Yes", "Also really lovely"));
		} else {
			ins.setQuestion("So, something really simple?");
			ins.setResponse(Arrays.asList("Sounds good", "Not that archaic","More archaic"));
		}
		insert(ins);
		ask(frame, ins);
		update(ins)
end


rule "Result->Ok, should it be pretty quick?"
	when
		m : Instance(question == "Ok, should it be pretty quick?")
	then
		Instance ins = new Instance();
		if (m.getDecision()==(m.getResponse().get(0))) {
			ins.setResponse (Arrays.asList("Lotus Elan"));
		} else {
			ins.setResponse(Arrays.asList("Alfa Romeo Giuilia Super"));
		}
		insert(ins);
		result(frame, ins);
		
end

rule "So, something really simple?"
	when
		m : Instance(question == "So, something really simple?")
	then
		Instance ins = new Instance();
		if (m.getDecision()==(m.getResponse().get(0))) {
			ins.setQuestion("Choose your car");
			ins.setResponse(Arrays.asList("Citroen 2CV", "VW Thing","Jeep","Honda Civic"));
			insert(ins);
			ask(frame,ins);
			update(ins);
		} else {if (m.getDecision()==(m.getResponse().get(1))){
			//ins.setQuestion("So, something really simple?");
			ins.setResponse(Arrays.asList("Ford Model A"));
			insert(ins);
			result(frame,ins);
			}
			else{
				ins.setResponse(Arrays.asList("Ford Model T"));
				insert(ins);
				result(frame,ins);
			}
		}
		
end

rule "Result -> multiple car choice"
	when
		m : Instance(question == "Choose your car")
	then
		Instance ins = new Instance();
		ins.setResponse(Arrays.asList(m.getDecision));
		insert(ins);
		result(frame, ins);
		
end



